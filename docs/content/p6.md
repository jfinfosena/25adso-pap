# Tutorial: Consumo de API con Streamlit

## IntroducciÃ³n

En este tutorial aprenderÃ¡s a crear una aplicaciÃ³n web simple con Streamlit que consume datos de una API REST. Streamlit es una biblioteca de Python que permite crear aplicaciones web interactivas de manera rÃ¡pida y sencilla.

## Â¿QuÃ© es Streamlit?

Streamlit es un framework open-source que convierte scripts de Python en aplicaciones web interactivas sin necesidad de conocimientos de HTML, CSS o JavaScript.

### Ventajas de Streamlit:
- **Simplicidad**: Solo necesitas Python
- **Rapidez**: Desarrollo muy rÃ¡pido
- **Interactividad**: Widgets automÃ¡ticos
- **Despliegue fÃ¡cil**: Streamlit Cloud gratuito

## InstalaciÃ³n

### Paso 1: Crear entorno virtual
```bash
# Crear entorno virtual
python -m venv streamlit_env

# Activar entorno virtual (Windows)
streamlit_env\Scripts\activate

# Activar entorno virtual (Linux/Mac)
source streamlit_env/bin/activate
```

### Paso 2: Instalar dependencias
```bash
pip install streamlit requests pandas
```

### Paso 3: Verificar instalaciÃ³n
```bash
streamlit --version
```

## Estructura del Proyecto

```
streamlit_api_tutorial/
â”œâ”€â”€ app.py              # AplicaciÃ³n principal
â”œâ”€â”€ api_client.py       # Cliente para consumir API
â”œâ”€â”€ requirements.txt    # Dependencias
â””â”€â”€ README.md          # DocumentaciÃ³n
```

## Ejemplo BÃ¡sico: Consumir API de JSONPlaceholder

### 1. Cliente API (api_client.py)

```python
import requests
import streamlit as st
from typing import List, Dict, Optional

class JSONPlaceholderClient:
    def __init__(self):
        self.base_url = "https://jsonplaceholder.typicode.com"
    
    def get_posts(self) -> Optional[List[Dict]]:
        """Obtener todos los posts"""
        try:
            response = requests.get(f"{self.base_url}/posts")
            response.raise_for_status()
            return response.json()
        except requests.exceptions.RequestException as e:
            st.error(f"Error al obtener posts: {e}")
            return None
    
    def get_post(self, post_id: int) -> Optional[Dict]:
        """Obtener un post especÃ­fico"""
        try:
            response = requests.get(f"{self.base_url}/posts/{post_id}")
            response.raise_for_status()
            return response.json()
        except requests.exceptions.RequestException as e:
            st.error(f"Error al obtener post {post_id}: {e}")
            return None
    
    def get_users(self) -> Optional[List[Dict]]:
        """Obtener todos los usuarios"""
        try:
            response = requests.get(f"{self.base_url}/users")
            response.raise_for_status()
            return response.json()
        except requests.exceptions.RequestException as e:
            st.error(f"Error al obtener usuarios: {e}")
            return None
```

### 2. AplicaciÃ³n Principal (app.py)

```python
import streamlit as st
import pandas as pd
from api_client import JSONPlaceholderClient

# ConfiguraciÃ³n de la pÃ¡gina
st.set_page_config(
    page_title="API Consumer",
    page_icon="ğŸŒ",
    layout="wide"
)

# Inicializar cliente API
@st.cache_resource
def init_api_client():
    return JSONPlaceholderClient()

api_client = init_api_client()

# TÃ­tulo principal
st.title("ğŸŒ Consumidor de API con Streamlit")
st.markdown("---")

# Sidebar para navegaciÃ³n
st.sidebar.title("ğŸ“‹ NavegaciÃ³n")
page = st.sidebar.selectbox(
    "Selecciona una pÃ¡gina:",
    ["ğŸ  Inicio", "ğŸ“„ Posts", "ğŸ‘¥ Usuarios", "ğŸ” Buscar Post"]
)

# PÃ¡gina de Inicio
if page == "ğŸ  Inicio":
    st.header("Bienvenido al Consumidor de API")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.info("ğŸ“„ **Posts**\nVer todas las publicaciones")
    
    with col2:
        st.info("ğŸ‘¥ **Usuarios**\nVer informaciÃ³n de usuarios")
    
    # EstadÃ­sticas rÃ¡pidas
    st.subheader("ğŸ“Š EstadÃ­sticas")
    
    if st.button("Cargar EstadÃ­sticas"):
        posts = api_client.get_posts()
        users = api_client.get_users()
        
        if posts and users:
            col1, col2, col3 = st.columns(3)
            
            with col1:
                st.metric("Total Posts", len(posts))
            
            with col2:
                st.metric("Total Usuarios", len(users))
            
            with col3:
                avg_posts = len(posts) / len(users)
                st.metric("Posts por Usuario", f"{avg_posts:.1f}")

# PÃ¡gina de Posts
elif page == "ğŸ“„ Posts":
    st.header("ğŸ“„ Lista de Posts")
    
    if st.button("ğŸ”„ Cargar Posts"):
        posts = api_client.get_posts()
        
        if posts:
            # Mostrar en tabla
            df = pd.DataFrame(posts)
            st.dataframe(df, use_container_width=True)
            
            # Mostrar posts individuales
            st.subheader("Posts Detallados")
            
            for post in posts[:5]:  # Mostrar solo los primeros 5
                with st.expander(f"ğŸ“„ {post['title'][:50]}..."):
                    st.write(f"**ID:** {post['id']}")
                    st.write(f"**Usuario ID:** {post['userId']}")
                    st.write(f"**TÃ­tulo:** {post['title']}")
                    st.write(f"**Contenido:** {post['body']}")

# PÃ¡gina de Usuarios
elif page == "ğŸ‘¥ Usuarios":
    st.header("ğŸ‘¥ Lista de Usuarios")
    
    if st.button("ğŸ”„ Cargar Usuarios"):
        users = api_client.get_users()
        
        if users:
            for user in users:
                with st.expander(f"ğŸ‘¤ {user['name']} (@{user['username']})"):
                    col1, col2 = st.columns(2)
                    
                    with col1:
                        st.write(f"**ID:** {user['id']}")
                        st.write(f"**Nombre:** {user['name']}")
                        st.write(f"**Username:** {user['username']}")
                        st.write(f"**Email:** {user['email']}")
                    
                    with col2:
                        st.write(f"**TelÃ©fono:** {user['phone']}")
                        st.write(f"**Website:** {user['website']}")
                        st.write(f"**Empresa:** {user['company']['name']}")
                        
                        # DirecciÃ³n
                        address = user['address']
                        st.write(f"**DirecciÃ³n:** {address['street']}, {address['city']}")

# PÃ¡gina de BÃºsqueda
elif page == "ğŸ” Buscar Post":
    st.header("ğŸ” Buscar Post por ID")
    
    post_id = st.number_input(
        "Ingresa el ID del post:",
        min_value=1,
        max_value=100,
        value=1,
        step=1
    )
    
    if st.button("Buscar Post"):
        post = api_client.get_post(post_id)
        
        if post:
            st.success("âœ… Post encontrado:")
            
            # Mostrar informaciÃ³n del post
            st.markdown(f"### {post['title']}")
            st.write(f"**ID:** {post['id']}")
            st.write(f"**Usuario ID:** {post['userId']}")
            st.write(f"**Contenido:**")
            st.write(post['body'])
        else:
            st.error("âŒ Post no encontrado")

# Footer
st.markdown("---")
st.markdown("**ğŸ’¡ Tip:** Esta aplicaciÃ³n consume la API pÃºblica de JSONPlaceholder")
```

### 3. Archivo de Dependencias (requirements.txt)

```txt
streamlit==1.29.0
requests==2.31.0
pandas==2.1.4
```

## Ejecutar la AplicaciÃ³n

### Paso 1: Crear los archivos
1. Crea una carpeta para tu proyecto
2. Crea los archivos `app.py`, `api_client.py` y `requirements.txt`
3. Copia el cÃ³digo correspondiente en cada archivo

### Paso 2: Instalar dependencias
```bash
pip install -r requirements.txt
```

### Paso 3: Ejecutar Streamlit
```bash
streamlit run app.py
```

### Paso 4: Acceder a la aplicaciÃ³n
- Abre tu navegador en `http://localhost:8501`
- Navega por las diferentes pÃ¡ginas
- Prueba las funcionalidades de consumo de API

## Funcionalidades Implementadas

âœ… **NavegaciÃ³n entre pÃ¡ginas**
âœ… **Consumo de API REST**
âœ… **VisualizaciÃ³n de datos en tablas**
âœ… **BÃºsqueda interactiva**
âœ… **Manejo de errores**
âœ… **Interfaz responsive**
âœ… **Cache de recursos**

