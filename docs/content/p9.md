# Clase 9: Streamlit Básico - Consumir API

## ¿Qué es Streamlit?

Streamlit es una herramienta que convierte código Python en páginas web. Es muy fácil de usar.

## Instalación

```bash
pip install streamlit requests
```

## Ejemplo 1: Mi Primera App

Crea un archivo llamado `app.py`:

```python
import streamlit as st
import requests

st.title("Mi Primera App")

if st.button("Obtener datos"):
    response = requests.get("https://jsonplaceholder.typicode.com/users")
    datos = response.json()
    
    st.write(f"Encontré {len(datos)} usuarios")
    
    for usuario in datos:
        st.write(f"- {usuario['name']} ({usuario['email']})")
```

**Ejecutar:**
```bash
streamlit run app.py
```

## Ejemplo 2: Mostrar Información de Usuario

```python
import streamlit as st
import requests

st.title("Información de Usuario")

# Selector de usuario
user_id = st.selectbox("Elige un usuario:", [1, 2, 3, 4, 5])

if st.button("Ver información"):
    url = f"https://jsonplaceholder.typicode.com/users/{user_id}"
    response = requests.get(url)
    usuario = response.json()
    
    st.write(f"**Nombre:** {usuario['name']}")
    st.write(f"**Email:** {usuario['email']}")
    st.write(f"**Teléfono:** {usuario['phone']}")
    st.write(f"**Ciudad:** {usuario['address']['city']}")
```

## Ejemplo 3: Formulario Simple

```python
import streamlit as st
import requests

st.title("Crear Post")

# Formulario
titulo = st.text_input("Título:")
contenido = st.text_area("Contenido:")

if st.button("Enviar"):
    if titulo and contenido:
        datos = {
            "title": titulo,
            "body": contenido,
            "userId": 1
        }
        
        response = requests.post(
            "https://jsonplaceholder.typicode.com/posts",
            json=datos
        )
        
        if response.status_code == 201:
            st.success("¡Post creado!")
        else:
            st.error("Error al crear post")
    else:
        st.warning("Completa todos los campos")
```

## Widgets Básicos

### Entrada de texto
```python
nombre = st.text_input("Tu nombre:")
mensaje = st.text_area("Tu mensaje:")
```

### Números
```python
edad = st.number_input("Tu edad:", min_value=0, max_value=100)
```

### Selección
```python
color = st.selectbox("Color favorito:", ["Rojo", "Azul", "Verde"])
```

### Checkbox
```python
acepto = st.checkbox("Acepto los términos")
```

### Botones
```python
if st.button("Hacer clic"):
    st.write("¡Hiciste clic!")
```

## Mostrar Información

### Texto simple
```python
st.write("Hola mundo")
st.text("Texto simple")
```

### Mensajes
```python
st.success("Todo bien")
st.error("Algo salió mal")
st.warning("Cuidado")
st.info("Información")
```

### Datos
```python
st.json({"nombre": "Juan", "edad": 25})
```

## Layout Básico

### Columnas
```python
col1, col2 = st.columns(2)

with col1:
    st.write("Columna 1")

with col2:
    st.write("Columna 2")
```

### Sidebar
```python
st.sidebar.write("Menú lateral")
opcion = st.sidebar.selectbox("Opciones:", ["A", "B", "C"])
```

## Ejemplo Completo: Lista de Posts

```python
import streamlit as st
import requests

st.title("📝 Lista de Posts")

# Sidebar
st.sidebar.title("Filtros")
user_filter = st.sidebar.selectbox(
    "Usuario:", 
    [0, 1, 2, 3, 4, 5],
    format_func=lambda x: "Todos" if x == 0 else f"Usuario {x}"
)

# Botón para cargar
if st.button("Cargar Posts"):
    # URL base
    url = "https://jsonplaceholder.typicode.com/posts"
    
    # Agregar filtro si es necesario
    if user_filter > 0:
        url += f"?userId={user_filter}"
    
    # Hacer petición
    response = requests.get(url)
    posts = response.json()
    
    # Mostrar resultados
    st.write(f"**Encontrados:** {len(posts)} posts")
    
    # Mostrar cada post
    for post in posts:
        with st.expander(f"Post {post['id']}: {post['title'][:30]}..."):
            st.write(f"**Usuario ID:** {post['userId']}")
            st.write(f"**Título completo:** {post['title']}")
            st.write(f"**Contenido:** {post['body']}")
```

## Manejo de Errores Simple

```python
import streamlit as st
import requests

def obtener_datos(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            return response.json()
        else:
            st.error(f"Error: {response.status_code}")
            return None
    except:
        st.error("No se pudo conectar")
        return None

# Uso
datos = obtener_datos("https://jsonplaceholder.typicode.com/users")
if datos:
    st.write("Datos cargados correctamente")
    st.write(datos)
```

## Cache Simple

```python
@st.cache_data
def cargar_usuarios():
    response = requests.get("https://jsonplaceholder.typicode.com/users")
    return response.json()

# Los datos se cargan solo una vez
usuarios = cargar_usuarios()
st.write(usuarios)
```

## Comandos Útiles

```bash
# Ejecutar app
streamlit run app.py

# Ejecutar en otro puerto
streamlit run app.py --server.port 8502

# Ver ayuda
streamlit --help
```

## Estructura de Archivos

```
mi_proyecto/
├── app.py
├── requirements.txt
└── README.md
```

**requirements.txt:**
```
streamlit
requests
```

